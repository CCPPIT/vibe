// ุงุณุชูุฑุงุฏ ุงูุฏูุงู ูุงููุญุฏุงุช ุงูุถุฑูุฑูุฉ ูู React Query ูsuperjson
import {
  defaultShouldDehydrateQuery, // ุงูุฏุงูุฉ ุงูุงูุชุฑุงุถูุฉ ููุชุญูู ูู ุฅููุงููุฉ ุชุฌููู ุงูุงุณุชุนูุงู
  QueryClient, // ุงูุนููู ุงูุฑุฆูุณู ูุฅุฏุงุฑุฉ ุงุณุชุนูุงูุงุช React Query
} from '@tanstack/react-query';
import superjson from 'superjson'; // ููุชุจุฉ ููุชุนุงูู ูุน ุงูุชุณููู (serialization) ุงููุชูุฏู

// ุฏุงูุฉ ูุฅูุดุงุก ูุชูููู ุนููู ุงุณุชุนูุงูุงุช ูุฎุตุต
export function makeQueryClient() {
  // ุฅุนุงุฏุฉ ุนููู ุงุณุชุนูุงูุงุช ุฌุฏูุฏ ูุน ุฅุนุฏุงุฏุงุช ูุฎุตุตุฉ
  return new QueryClient({
    // ุงูุฅุนุฏุงุฏุงุช ุงูุงูุชุฑุงุถูุฉ ููุนููู
    defaultOptions: {
      // ุฅุนุฏุงุฏุงุช ุงูุงุณุชุนูุงูุงุช (Queries)
      queries: {
        // ููุช ุงูุชูุงุก ุตูุงุญูุฉ ุงูุจูุงูุงุช (ุจุงููููู ุซุงููุฉ) - 30 ุซุงููุฉ
        // ุจุนุฏ ูุฐู ุงููุฏุฉ ุชุตุจุญ ุงูุจูุงูุงุช "stale" ููุฏ ูุชู ุฅุนุงุฏุฉ fetch
        staleTime: 30 * 1000,
      },
      // ุฅุนุฏุงุฏุงุช ุนูููุฉ ุงูุชุฌููู (Dehydration) - ููุชุฎุฒูู ุงููุคูุช ูู SSR
      dehydrate: {
        // โ ุชู ุชุนููู serializeData ููุฌูุฏ ูุดููุฉ ูุญุชููุฉ ูู ุงูุฅุตุฏุงุฑุงุช ุงูุญุฏูุซุฉ
        // serializeData: superjson.serialize, // ุงุณุชุฎุฏุงู superjson ูุชุณููู ุงูุจูุงูุงุช
        
        // ุงูุฏุงูุฉ ุงูุชู ุชุญุฏุฏ ุฅุฐุง ูุงู ูุฌุจ ุชุฌููู ุงูุงุณุชุนูุงู ุฃู ูุง
        shouldDehydrateQuery: (query) =>
          defaultShouldDehydrateQuery(query) || // ุงูุดุฑุท ุงูุงูุชุฑุงุถู ููุชุฌููู
          query.state.status === 'pending', // || ุชุฌููู ุงูุงุณุชุนูุงูุงุช ุงูุชู ูุง ุชุฒุงู ููุฏ ุงูุชูููุฐ (pending)
      },
      // ุฅุนุฏุงุฏุงุช ุนูููุฉ ุฅุนุงุฏุฉ ุงูุชูููู (Hydration) - ูุงุณุชุฑุฌุงุน ุงูุจูุงูุงุช ุงููุฌููุฉ
      hydrate: {
        // โ ุชู ุชุนููู deserializeData ููุฌูุฏ ูุดููุฉ ูุญุชููุฉ ูู ุงูุฅุตุฏุงุฑุงุช ุงูุญุฏูุซุฉ  
         deserializeData: superjson.deserialize, // ุงุณุชุฎุฏุงู superjson ูุฅุนุงุฏุฉ ุชุญููู ุงูุจูุงูุงุช
      },
    },
  });
}

// ๐ ุดุฑุญ ุงููุดููุฉ ุงููุญุชููุฉ:

// โ ุณุจุจ ุงูุชุนููู ุนูู superjson:
// - ููุงู ูุดููุฉ ูุนุฑููุฉ ูู ุชูุงูู superjson ูุน ุงูุฅุตุฏุงุฑุงุช ุงูุญุฏูุซุฉ ูู React Query
// - ูุฏ ุชุณุจุจ ุฃุฎุทุงุก ูู ุงูุชุณููู ุฃู ุฅุนุงุฏุฉ ุงูุชูููู
// - ูุชู ุงูุจุญุซ ุนู ุจุฏูู ุฃู ุฅุตูุงุญ ูููุดููุฉ

// ๐ ุงูุจุฏุงุฆู ุงูููุชุฑุญุฉ:

// 1. ุงุณุชุฎุฏุงู JSON ุงูุนุงุฏู (ูุคูุชุงู):
/*
dehydrate: {
  shouldDehydrateQuery: (query) =>
    defaultShouldDehydrateQuery(query) ||
    query.state.status === 'pending',
},
hydrate: {
  // ูุง ุญุงุฌุฉ ูุฅุนุฏุงุฏุงุช ุฅุถุงููุฉ
}
*/

// 2. ุงุณุชุฎุฏุงู ูุญูู ุจูุงูุงุช ูุฎุตุต:
/*
dehydrate: {
  serializeData: (data) => {
    // ูุนุงูุฌุฉ ูุฏููุฉ ููุฃููุงุน ุงููุนูุฏุฉ ูุซู Date
    return JSON.parse(JSON.stringify(data));
  },
},
hydrate: {
  deserializeData: (data) => {
    // ูุนุงูุฌุฉ ูุฏููุฉ ูุฅุนุงุฏุฉ ุชุญููู ุงูุฃููุงุน
    return data;
  },
},
*/

// ๐ฏ ุงูุบุฑุถ ูู ุงูุฅุนุฏุงุฏุงุช:

// 1. staleTime: 30 * 1000 (30 ุซุงููุฉ)
//    - ุชุญุณูู ุงูุฃุฏุงุก ุจุชูููู ุทูุจุงุช ุงูุดุจูุฉ ุงููุชูุฑุฑุฉ
//    - ุงูุญูุงุธ ุนูู ุงูุจูุงูุงุช "ุทุงุฒุฌุฉ" ููุฏุฉ 30 ุซุงููุฉ
//    - ุจุนุฏ 30 ุซุงููุฉุ ุชุตุจุญ ุงูุจูุงูุงุช "stale" ููุฏ ูุชู ุฅุนุงุฏุฉ fetch

// 2. ุชุฌููู ุงูุงุณุชุนูุงูุงุช pending:
//    - ููู ูุชุญุณูู ุชุฌุฑุจุฉ SSR (Server-Side Rendering)
//    - ูุณูุญ ุจุงุณุชููุงู ุงูุงุณุชุนูุงูุงุช ุนูู ุงูุนููู ุจุนุฏ ุงูุชุตููุฑ ูู ุงูุฎุงุฏู
//    - ูููุน ุฅุนุงุฏุฉ fetch ุบูุฑ ุงูุถุฑูุฑูุฉ ููุจูุงูุงุช ุงูุชู ูุงูุช ููุฏ ุงูุชุญููู

// โ๏ธ ุงููุดุงูู ุงููุญุชููุฉ:

// 1. ุจุฏูู superjson:
//    - ููุฏุงู ุฃููุงุน ุงูุจูุงูุงุช ุงููุนูุฏุฉ (Date, Map, Set, etc.)
//    - ุชุญุชุงุฌ ุฅูู ูุนุงูุฌุฉ ูุฏููุฉ ููุฃููุงุน ูู ุงูุชุทุจูู

// 2. ูุน superjson (ูุนูู ุญุงููุงู):
//    - ูุดุงูู ูู ุงูุชูุงูู ูุน ุงูุฅุตุฏุงุฑุงุช ุงูุญุฏูุซุฉ
//    - ุฃุฎุทุงุก ูู ุนูููุฉ ุงูุชุณููู/ุฅุนุงุฏุฉ ุงูุชูููู

// ๐ก ุงูุญููู ุงูููุชุฑุญุฉ:

// ุงูุญู ุงูุฃูู: ุงูุงูุชุธุงุฑ ูุชุญุฏูุซ ุงูููุชุจุงุช
/*
// ุนูุฏูุง ูุชู ุฅุตูุงุญ ุงููุดููุฉ:
dehydrate: {
  serializeData: superjson.serialize,
  shouldDehydrateQuery: (query) =>
    defaultShouldDehydrateQuery(query) ||
    query.state.status === 'pending',
},
hydrate: {
  deserializeData: superjson.deserialize,
}
*/

// ุงูุญู ุงูุซุงูู: ุงุณุชุฎุฏุงู ุฅุตุฏุงุฑุงุช ูุชูุงููุฉ
// - ุงูุนูุฏุฉ ุฅูู ุฅุตุฏุงุฑุงุช ุณุงุจูุฉ ูู React Query ุฃู superjson
// - ุงูุจุญุซ ุนู ุฅุตุฏุงุฑุงุช ูุนุฑููุฉ ุจุงูุงุณุชูุฑุงุฑ

// ๐ง ุงูุงุณุชุฎุฏุงู ุงููุชููุน:
// ูุชู ุงุณุชุฏุนุงุก ูุฐู ุงูุฏุงูุฉ ูู:
// - ุงูุฎุงุฏู: ููู ุทูุจ (ูุถูุงู ุงูุนุฒู ุจูู ุงููุณุชุฎุฏููู)
// - ุงูุนููู: ูุฑุฉ ูุงุญุฏุฉ (ูููุดุงุฑูุฉ ุจูู ุงูููููุงุช)

// ๐ฆ ูุซุงู ุงูุงุณุชุฎุฏุงู:
/*
// ุนูู ุงูุฎุงุฏู (ูู ูู ุทูุจ) - ูููููุงุช Server Components
import { makeQueryClient } from './query-client';
const queryClient = makeQueryClient();

// ุนูู ุงูุนููู (ูุฑุฉ ูุงุญุฏุฉ) - ูู Provider
import { useState } from 'react';
import { makeQueryClient } from './query-client';
const [queryClient] = useState(() => makeQueryClient());
*/

// ๐ฏ ููุงุฆุฏ ูุฐุง ุงูุฅุนุฏุงุฏ:
// 1. ุชุญุณูู ุฃุฏุงุก ุงูุชุทุจูู ุจุชูููู ุทูุจุงุช ุงูุดุจูุฉ ุบูุฑ ุงูุถุฑูุฑูุฉ
// 2. ุฏุนู ุชุฌุฑุจุฉ SSR ุจุดูู ุฃูุถู ุจุงุณุชููุงู ุงูุงุณุชุนูุงูุงุช ุนูู ุงูุนููู
// 3. ุงูุชุญูู ูู ูุฏุฉ ุตูุงุญูุฉ ุงูุจูุงูุงุช ููุชุญุฏูุซ ุงูุชููุงุฆู
// 4. ุชุญุณูู ุชุฌุฑุจุฉ ุงููุณุชุฎุฏู ุจุชูููู ููุช ุงูุชุญููู

// โ๏ธ ุชุญุฐูุฑุงุช:
// - ุงูุชุฃูุฏ ูู ุชูุงูู ุงูุฅุตุฏุงุฑุงุช ูุจู ุฅุนุงุฏุฉ ุชูููู superjson
// - ุงุฎุชุจุงุฑ ูุธููุฉ ุงูุชุฌููู/ุฅุนุงุฏุฉ ุงูุชูููู ุจุดูู ุดุงูู
// - ูุฑุงูุจุฉ ุฃุฏุงุก ุงูุชุทุจูู ุจุนุฏ ุงูุชุบููุฑุงุช